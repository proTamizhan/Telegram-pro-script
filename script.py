import base64

exec(base64.b64decode(b'ZnJvbSB0ZWxldGhvbi5zeW5jIGltcG9ydCBUZWxlZ3JhbUNsaWVudApmcm9tIHRlbGV0aG9uLmVycm9ycy5ycGNlcnJvcmxpc3QgaW1wb3J0IFBob25lTnVtYmVyQmFubmVkRXJyb3IKaW1wb3J0IHBpY2tsZSwgb3MKZnJvbSBjb2xvcmFtYSBpbXBvcnQgaW5pdCwgRm9yZQpmcm9tIHRpbWUgaW1wb3J0IHNsZWVwCgppbml0KCkKCm4gPSBGb3JlLlJFU0VUCmxnID0gRm9yZS5MSUdIVEdSRUVOX0VYCnIgPSBGb3JlLlJFRAp3ID0gRm9yZS5XSElURQpjeSA9IEZvcmUuQ1lBTgp5ZSA9IEZvcmUuWUVMTE9XCmNvbG9ycyA9IFtsZywgciwgdywgY3ksIHllXQoKdHJ5OgogICAgaW1wb3J0IHJlcXVlc3RzCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIHByaW50KGYne2xnfVtpXSBJbnN0YWxsaW5nIG1vZHVsZSAtIHJlcXVlc3RzLi4ue259JykKICAgIG9zLnN5c3RlbSgncGlwIGluc3RhbGwgcmVxdWVzdHMnKQoKZGVmIGJhbm5lcigpOgogICAgaW1wb3J0IHJhbmRvbQogICAgIyBmYW5jeSBsb2dvCiAgICBiID0gWyAgCiAgICAgICAgJyAgICBUZWxlZ3JhbSBwcm8gbWVtYmVyIGFkZGVyICcsCiAgICAnICAgICAgICAgICAgS2FybWEgYWRkZXIgICAgICcsICAgICAgICAKJ0J5IC0gQFRoZVRlbGVHcmFtUHJvJyAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICBdCiAgICBmb3IgY2hhciBpbiBiOgogICAgICAgIHByaW50KGYne3JhbmRvbS5jaG9pY2UoY29sb3JzKX17Y2hhcn17bn0nKQoKICAgIHByaW50KGYnICBWZXJzaW9uOiAzLjIgfCBBdXRob3I6IHRlbGVncmFtIHBybyB8IFRFQU0gS0FSTUF7bn1cbicpCgpkZWYgY2xyKCk6CiAgICBpZiBvcy5uYW1lID09ICdudCc6CiAgICAgICAgb3Muc3lzdGVtKCdjbHMnKQogICAgZWxzZToKICAgICAgICBvcy5zeXN0ZW0oJ2NsZWFyJykKCndoaWxlIFRydWU6CiAgICBjbHIoKQogICAgYmFubmVyKCkKICAgIHByaW50KGxnKydbMV0gQWRkIG5ldyBhY2NvdW50cycrbikKICAgIHByaW50KGxnKydbMl0gRmlsdGVyIGFsbCBiYW5uZWQgYWNjb3VudHMnK24pCiAgICBwcmludChsZysnWzNdIERlbGV0ZSBzcGVjaWZpYyBhY2NvdW50cycrbikKICAgIHByaW50KGxnKydbNF0gVXBkYXRlIHlvdXIga2FybWEnK24pCiAgICBwcmludChsZysnWzVdIFF1aXQnK24pCiAgICBhID0gaW50KGlucHV0KCdcbkVudGVyIHlvdXIgY2hvaWNlOiAnKSkKICAgIGlmIGEgPT0gMToKICAgICAgICBuZXdfYWNjcyA9IFtdCiAgICAgICAgd2l0aCBvcGVuKCd2YXJzLnR4dCcsICdhYicpIGFzIGc6CiAgICAgICAgICAgIG51bWJlcl90b19hZGQgPSBpbnQoaW5wdXQoZidcbntsZ30gW35dIEVudGVyIG51bWJlciBvZiBhY2NvdW50cyB0byBhZGQ6IHtyfScpKQogICAgICAgICAgICBmb3IgaSBpbiByYW5nZShudW1iZXJfdG9fYWRkKToKICAgICAgICAgICAgICAgIHBob25lX251bWJlciA9IHN0cihpbnB1dChmJ1xue2xnfSBbfl0gRW50ZXIgUGhvbmUgTnVtYmVyOiB7cn0nKSkKICAgICAgICAgICAgICAgIHBhcnNlZF9udW1iZXIgPSAnJy5qb2luKHBob25lX251bWJlci5zcGxpdCgpKQogICAgICAgICAgICAgICAgcGlja2xlLmR1bXAoW3BhcnNlZF9udW1iZXJdLCBnKQogICAgICAgICAgICAgICAgbmV3X2FjY3MuYXBwZW5kKHBhcnNlZF9udW1iZXIpCiAgICAgICAgICAgIHByaW50KGYnXG57bGd9IFtpXSBTYXZlZCBhbGwgYWNjb3VudHMgaW4gdmFycy50eHQnKQogICAgICAgICAgICBjbHIoKQogICAgICAgICAgICBwcmludChmJ1xue2xnfSBbKl0gTG9nZ2luZyBpbiBmcm9tIG5ldyBhY2NvdW50c1xuJykKICAgICAgICAgICAgZm9yIG51bWJlciBpbiBuZXdfYWNjczoKICAgICAgICAgICAgICAgIGMgPSBUZWxlZ3JhbUNsaWVudChmJ3Nlc3Npb25zL3tudW1iZXJ9JywgMzkxMDM4OSAsICc4NmY4NjEzNTJmMGFiNzZhMjUxODY2MDU5YTZhZGJkNicpCiAgICAgICAgICAgICAgICBjLnN0YXJ0KG51bWJlcikKICAgICAgICAgICAgICAgIHByaW50KGYne2xnfVsrXSBMb2dpbiBzdWNjZXNzZnVsJykKICAgICAgICAgICAgICAgIGMuZGlzY29ubmVjdCgpCiAgICAgICAgICAgIGlucHV0KGYnXG4gUHJlc3MgZW50ZXIgdG8gZ290byBtYWluIG1lbnUuLi4nKQoKICAgICAgICBnLmNsb3NlKCkKICAgIGVsaWYgYSA9PSAyOgogICAgICAgIGFjY291bnRzID0gW10KICAgICAgICBiYW5uZWRfYWNjcyA9IFtdCiAgICAgICAgaCA9IG9wZW4oJ3ZhcnMudHh0JywgJ3JiJykKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBhY2NvdW50cy5hcHBlbmQocGlja2xlLmxvYWQoaCkpCiAgICAgICAgICAgIGV4Y2VwdCBFT0ZFcnJvcjoKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgaC5jbG9zZSgpCiAgICAgICAgaWYgbGVuKGFjY291bnRzKSA9PSAwOgogICAgICAgICAgICBwcmludChyKydbIV0gVGhlcmUgYXJlIG5vIGFjY291bnRzISBQbGVhc2UgYWRkIHNvbWUgYW5kIHJldHJ5JykKICAgICAgICAgICAgc2xlZXAoMykKICAgICAgICBlbHNlOgogICAgICAgICAgICBmb3IgYWNjb3VudCBpbiBhY2NvdW50czoKICAgICAgICAgICAgICAgIHBob25lID0gc3RyKGFjY291bnRbMF0pCiAgICAgICAgICAgICAgICBjbGllbnQgPSBUZWxlZ3JhbUNsaWVudChmJ3Nlc3Npb25zL3twaG9uZX0nLCAzOTEwMzg5ICwgJzg2Zjg2MTM1MmYwYWI3NmEyNTE4NjYwNTlhNmFkYmQ2JykKICAgICAgICAgICAgICAgIGNsaWVudC5jb25uZWN0KCkKICAgICAgICAgICAgICAgIGlmIG5vdCBjbGllbnQuaXNfdXNlcl9hdXRob3JpemVkKCk6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBjbGllbnQuc2VuZF9jb2RlX3JlcXVlc3QocGhvbmUpCiAgICAgICAgICAgICAgICAgICAgICAgICNjbGllbnQuc2lnbl9pbihwaG9uZSwgaW5wdXQoJ1srXSBFbnRlciB0aGUgY29kZTogJykpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYne2xnfVsrXSB7cGhvbmV9IGlzIG5vdCBiYW5uZWR7bn0nKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBQaG9uZU51bWJlckJhbm5lZEVycm9yOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludChyK3N0cihwaG9uZSkgKyAnIGlzIGJhbm5lZCEnK24pCiAgICAgICAgICAgICAgICAgICAgICAgIGJhbm5lZF9hY2NzLmFwcGVuZChhY2NvdW50KQogICAgICAgICAgICBpZiBsZW4oYmFubmVkX2FjY3MpID09IDA6CiAgICAgICAgICAgICAgICBwcmludChsZysnQ29uZ3JhdHMhIE5vIGJhbm5lZCBhY2NvdW50cycpCiAgICAgICAgICAgICAgICBpbnB1dCgnXG5QcmVzcyBlbnRlciB0byBnb3RvIG1haW4gbWVudS4uLicpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBmb3IgbSBpbiBiYW5uZWRfYWNjczoKICAgICAgICAgICAgICAgICAgICBhY2NvdW50cy5yZW1vdmUobSkKICAgICAgICAgICAgICAgIHdpdGggb3BlbigndmFycy50eHQnLCAnd2InKSBhcyBrOgogICAgICAgICAgICAgICAgICAgIGZvciBhIGluIGFjY291bnRzOgogICAgICAgICAgICAgICAgICAgICAgICBQaG9uZSA9IGFbMF0KICAgICAgICAgICAgICAgICAgICAgICAgcGlja2xlLmR1bXAoW1Bob25lXSwgaykKICAgICAgICAgICAgICAgIGsuY2xvc2UoKQogICAgICAgICAgICAgICAgcHJpbnQobGcrJ1tpXSBBbGwgYmFubmVkIGFjY291bnRzIHJlbW92ZWQnK24pCiAgICAgICAgICAgICAgICBpbnB1dCgnXG5QcmVzcyBlbnRlciB0byBnb3RvIG1haW4gbWVudS4uLicpCgogICAgZWxpZiBhID09IDM6CiAgICAgICAgYWNjcyA9IFtdCiAgICAgICAgZiA9IG9wZW4oJ3ZhcnMudHh0JywgJ3JiJykKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBhY2NzLmFwcGVuZChwaWNrbGUubG9hZChmKSkKICAgICAgICAgICAgZXhjZXB0IEVPRkVycm9yOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICBmLmNsb3NlKCkKICAgICAgICBpID0gMAogICAgICAgIHByaW50KGYne2xnfVtpXSBDaG9vc2UgYW4gYWNjb3VudCB0byBkZWxldGVcbicpCiAgICAgICAgZm9yIGFjYyBpbiBhY2NzOgogICAgICAgICAgICBwcmludChmJ3tsZ31be2l9XSB7YWNjWzBdfXtufScpCiAgICAgICAgICAgIGkgKz0gMQogICAgICAgIGluZGV4ID0gaW50KGlucHV0KGYnXG57bGd9WytdIEVudGVyIGEgY2hvaWNlOiB7bn0nKSkKICAgICAgICBwaG9uZSA9IHN0cihhY2NzW2luZGV4XVswXSkKICAgICAgICBzZXNzaW9uX2ZpbGUgPSBwaG9uZSArICcuc2Vzc2lvbicKICAgICAgICBpZiBvcy5uYW1lID09ICdudCc6CiAgICAgICAgICAgIG9zLnN5c3RlbShmJ2RlbCBzZXNzaW9uc1xce3Nlc3Npb25fZmlsZX0nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG9zLnN5c3RlbShmJ3JtIHNlc3Npb25zL3tzZXNzaW9uX2ZpbGV9JykKICAgICAgICBkZWwgYWNjc1tpbmRleF0KICAgICAgICBmID0gb3BlbigndmFycy50eHQnLCAnd2InKQogICAgICAgIGZvciBhY2NvdW50IGluIGFjY3M6CiAgICAgICAgICAgIHBpY2tsZS5kdW1wKGFjY291bnQsIGYpCiAgICAgICAgcHJpbnQoZidcbntsZ31bK10gQWNjb3VudCBEZWxldGVke259JykKICAgICAgICBpbnB1dChmJ1xuUHJlc3MgZW50ZXIgdG8gZ290byBtYWluIG1lbnUuLi4nKQogICAgICAgIGYuY2xvc2UoKQogICAgZWxpZiBhID09IDQ6CiAgICAgICAgIyB0aGFua3MgdG8gZ2l0aHViLmNvbS90aDN1bmtuMG4gZm9yIHRoZSBzbmlwcGV0IGJlbG93CiAgICAgICAgcHJpbnQoZidcbntsZ31baV0gQ2hlY2tpbmcgZm9yIHVwZGF0ZXMuLi4nKQogICAgICAgIHRyeToKICAgICAgICAgICAgIyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vQ3J5cHRvbmlhbjAwNy96aWxsYS9tYWluL3ZlcnNpb24udHh0CiAgICAgICAgICAgIHZlcnNpb24gPSByZXF1ZXN0cy5nZXQoJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9DcnlwdG9uaWFuMDA3emlsbGEvbWFpbi92ZXJzaW9uLnR4dCcpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmJ3tyfSBZb3UgYXJlIG5vdCBjb25uZWN0ZWQgdG8gdGhlIGludGVybmV0JykKICAgICAgICAgICAgcHJpbnQoZid7cn0gUGxlYXNlIGNvbm5lY3QgdG8gdGhlIGludGVybmV0IGFuZCByZXRyeScpCiAgICAgICAgICAgIGV4aXQoKQogICAgICAgIGlmIGZsb2F0KHZlcnNpb24udGV4dCkgPiAxLjE6CiAgICAgICAgICAgIHByb21wdCA9IHN0cihpbnB1dChmJ3tsZ31bfl0gVXBkYXRlIGF2YWlsYWJsZVtWZXJzaW9uIHt2ZXJzaW9uLnRleHR9XS4gRG93bmxvYWQ/W3kvbl06IHtyfScpKQogICAgICAgICAgICBpZiBwcm9tcHQgPT0gJ3knIG9yIHByb21wdCA9PSAneWVzJyBvciBwcm9tcHQgPT0gJ1knOgogICAgICAgICAgICAgICAgcHJpbnQoZid7bGd9W2ldIERvd25sb2FkaW5nIHVwZGF0ZXMuLi4nKQogICAgICAgICAgICAgICAgaWYgb3MubmFtZSA9PSAnbnQnOgogICAgICAgICAgICAgICAgICAgIG9zLnN5c3RlbSgnZGVsIGFkZC5weScpCiAgICAgICAgICAgICAgICAgICAgb3Muc3lzdGVtKCdkZWwgbWFuYWdlci5weScpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIG9zLnN5c3RlbSgncm0gYWRkLnB5JykKICAgICAgICAgICAgICAgICAgICBvcy5zeXN0ZW0oJ3JtIG1hbmFnZXIucHknKQogICAgICAgICAgICAgICAgI29zLnN5c3RlbSgnZGVsIHNjcmFwZXIucHknKQogICAgICAgICAgICAgICAgb3Muc3lzdGVtKCdjdXJsIC1sIC1PIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9DcnlwdG9uaWFuMDA3L3ppbGxhL21haW4vYWRkLnB5JykKICAgICAgICAgICAgICAgIG9zLnN5c3RlbSgnY3VybCAtbCAtTyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vQ3J5cHRvbmlhbjAwNy96aWxsYS9tYWluL21hbmFnZXIucHknKQogICAgICAgICAgICAgICAgcHJpbnQoZid7bGd9WypdIFVwZGF0ZWQgdG8gdmVyc2lvbjoge3ZlcnNpb24udGV4dH0nKQogICAgICAgICAgICAgICAgaW5wdXQoJ1ByZXNzIGVudGVyIHRvIGV4aXQuLi4nKQogICAgICAgICAgICAgICAgZXhpdCgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludChmJ3tsZ31bIV0gVXBkYXRlIGFib3J0ZWQuJykKICAgICAgICAgICAgICAgIGlucHV0KCdQcmVzcyBlbnRlciB0byBnb3RvIG1haW4gbWVudS4uLicpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoZid7bGd9W2ldIFlvdXIga2FybWEgaXMgYWxyZWFkeSB1cCB0byBkYXRlJykKICAgICAgICAgICAgaW5wdXQoJ1ByZXNzIGVudGVyIHRvIGdvdG8gbWFpbiBtZW51Li4uJykKICAgIGVsaWYgYSA9PSA1OgogICAgICAgIGNscigpCiAgICAgICAgYmFubmVyKCkKICAgICAgICBleGl0KCkK=='))
